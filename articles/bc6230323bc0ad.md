---
title: "[æ©Ÿæ¢°å­¦ç¿’]KNN(Kè¿‘å‚æ³•)ã®ä»•çµ„ã¿"
emoji: "ğŸ¤–"
type: "tech"
topics: ["python", "scikitlearn", "æ©Ÿæ¢°å­¦ç¿’", "ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹", "knn"]
published: true
---

# æ¦‚è¦
ã“ã®è¨˜äº‹ã§ã¯K nearest neighbors/Kè¿‘å‚æ³•(ä»¥ä¸‹ã€KNNã¨å‘¼ã¶)ã«ã¤ã„ã¦èª¬æ˜ã™ã‚‹ã€‚

KNNã¯ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒå…¥åŠ›ã•ã‚ŒãŸã¨ãã«ãã‚Œã«è¿‘ã„$\bf{k}$å€‹ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šã€ãã‚Œã‚‰ã®ãƒ©ãƒ™ãƒ«ã®å¤šæ•°æ±ºã‚’æ¡ã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ãƒ©ãƒ™ãƒ«ã‚’äºˆæ¸¬ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚‹ã€‚

æœ¬è¨˜äº‹ã§ã¯ã€èº«é•·ãƒ»ä½“é‡(ç‰¹å¾´é‡)ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ã€æ€§åˆ¥(ãƒ©ãƒ™ãƒ«)åˆ¤æ–­ã‚’ã™ã‚‹å…·ä½“ä¾‹ã‚’ç”¨ã„ã¦KNNã®æŒ™å‹•ã‚’èª¬æ˜ã™ã‚‹ã€‚

ã¾ãŸã€KNNã®æ•°å¼ã§ã®è¡¨ç¾ã«ã¤ã„ã¦ã‚‚æ‰±ã†ã€‚

# ã¯ã˜ã‚ã«
KNNã¯åˆ†é¡æ‰‹æ³•ã®ã²ã¨ã¤ã ã€‚

KNNã¯Evelyn Fixã¨Joseph Hodgesã¨ã„ã†äºŒäººã®çµ±è¨ˆå­¦è€…ã«ã‚ˆã£ã¦1951å¹´ã«ç™ºè¡¨ã•ã‚ŒãŸ[1]ã€‚
ç¾åœ¨ã§ã‚‚ä½¿ã‚ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã€æ”¹è‰¯ã‚‚ã•ã‚Œã¦ã„ã‚‹ã€‚[2]

KNNã¯ã€Œãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‹ã‚‰è¿‘ã„é †ã«é©åˆ‡ãªå€‹æ•°ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚Œã°ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®ãƒ©ãƒ™ãƒ«ã‚’ç‰¹å®šå‡ºæ¥ã‚‹ã€ã¨ã„ã†ä»®èª¬ã‚’ç½®ã„ãŸãƒ¢ãƒ‡ãƒ«ã ã€‚

## å‰æçŸ¥è­˜
### ç‰¹å¾´é‡ã¨ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿/ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
ç‰¹å¾´é‡ã¨ã¯ãã‚Œãã‚Œã®ãƒ‡ãƒ¼ã‚¿ã®ç‰¹å¾´ã‚’è¡¨ã™å€¤ã®é›†åˆã§ã€ãƒ™ã‚¯ãƒˆãƒ«ã‚’ç”¨ã„ã¦è¡¨ã™ã“ã¨ãŒå‡ºæ¥ã‚‹ã€‚

ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¨ã¯ã€ãƒ¢ãƒ‡ãƒ«ãŒã€Œå…¥åŠ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã€(ç‰¹å¾´é‡)ã‹ã‚‰ã€Œä½•ã‚‰ã‹ã®çµæœã€(ãƒ©ãƒ™ãƒ«)ã‚’äºˆæ¸¬å‡ºæ¥ã‚‹ã‚ˆã†è¨“ç·´ã‚’ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã ã€‚
ã“ã†ã„ã£ãŸç›®çš„ã«å¿œãˆã‚‹ãŸã‚ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã«ã¯å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã ã‘ã§ãªãã€äºˆæ¸¬çµæœã§ã‚ã‚‹ãƒ©ãƒ™ãƒ«æƒ…å ±ã‚‚ä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã€‚
â€»ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒãƒˆ(ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®é›†åˆ)ã‚’ãƒ¢ãƒ‡ãƒ«ã«å­¦ç¿’ã•ã›ã‚‹ã“ã¨ã‚’[æ•™å¸«ã‚ã‚Šå­¦ç¿’](https://ja.wikipedia.org/wiki/%E6%95%99%E5%B8%AB%E3%81%82%E3%82%8A%E5%AD%A6%E7%BF%92)ã¨è¨€ã†ã€‚

ä¸€æ–¹ã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ã ã€‚ãƒ¢ãƒ‡ãƒ«ã¯ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ãƒ©ãƒ™ãƒ«ã‚’å‚ç…§å‡ºæ¥ãªã„ã€‚

### ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯(parametric)ã¨ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯(non-parametric)
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼(parameter)ã¨ã¯åˆ†å¸ƒã‚’è¦ç¨‹ã™ã‚‹å¤‰æ•°ã®ã“ã¨ã ã€‚ä¾‹ãˆã°æ­£è¦åˆ†å¸ƒã§ã¯å¹³å‡ã¨åˆ†æ•£ãŒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãƒ¢ãƒ‡ãƒ«**ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å€‹æ•°ãŒã€Œå›ºå®šçš„ãªæ•°å€¤ã§ã‚ã‚‹ã€ã®ã«å¯¾ã—ã¦**ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãƒ¢ãƒ‡ãƒ«**ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å€‹æ•°ãŒã€Œãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®å¢—åŠ ã«ä¼´ã„å¢—åŠ ã™ã‚‹ã€ã¨ã„ã†é•ã„ãŒã‚ã‚‹ã€‚
â€»ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãƒ¢ãƒ‡ãƒ«ã¯ãƒ‡ãƒ¼ã‚¿ãã®ã‚‚ã®ãŒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å½¹å‰²ã‚’ã—ã¦ã„ã‚‹ã¨ã‚‚è¨€ãˆã‚‹ã€‚
 
ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãªãƒ¢ãƒ‡ãƒ«ã¯æ¯”è¼ƒçš„ã™ãã«ä½¿ã†ã“ã¨ãŒå‡ºæ¥ã‚‹ã¨ã„ã†å„ªã‚ŒãŸç‚¹ã‚’æŒã¤ä¸€æ–¹ã§ãƒ‡ãƒ¼ã‚¿åˆ†å¸ƒã®æ€§è³ªã«å¯¾ã—ã¦ã‚ˆã‚Šå¼·åŠ›ãªä»®å®šã‚’ç½®ã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†æ¬ ç‚¹ã‚‚ã‚ã‚‹ã€‚
ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãƒ¢ãƒ‡ãƒ«ã¯ã‚ˆã‚ŠæŸ”è»Ÿã«é‹ç”¨å‡ºæ¥ã‚‹åˆ©ç‚¹ã‚’æŒã¤ãŒã€å¤§è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã¯è¨ˆç®—é‡çš„ã«å›°é›£ã‚’ããŸã™ã“ã¨ã‚‚ã‚ã‚‹ã€‚
 
### ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢(euclidean distance)
ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ç©ºé–“(è¦ã¯æ™®é€šã®å¹¾ä½•å­¦ã®ä¸–ç•Œ)ã«ãŠã‘ã‚‹äºŒç‚¹é–“ã®ç›´ç·šè·é›¢ã®ã“ã¨ã‚’ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ã¨è¨€ã†ã€‚
![](https://storage.googleapis.com/zenn-user-upload/a2uzabftz5fknh762q0ojawxmcr5)
>[Euclidean distance / Wikipediaã‚ˆã‚Š](https://en.wikipedia.org/wiki/Euclidean_distance#:~:text=In%20mathematics%2C%20the%20Euclidean%20distance,being%20called%20the%20Pythagorean%20distance.)

ä¸Šè¨˜ã®å›³ã‚ˆã‚Šã‚‚ã‚ã‹ã‚‹é€šã‚Šã€ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ã¯åº§æ¨™ä¸Šã®å„è»¸ã®å·®ã®2ä¹—ã®å’Œã®æ­£ã®å¹³æ–¹æ ¹ã§è¨ˆç®—å‡ºæ¥ã‚‹ã€‚

# 1.KNNã¨ã¯ãªã«ã‹
 KNNã¯ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãªåˆ†é¡æ‰‹æ³•ã®ä¸€ã¤ã ã€‚KNNã¯ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒãƒˆã®ä¸­ã‹ã‚‰ãƒ†ã‚¹ãƒˆå…¥åŠ›ã®ç‰¹å¾´é‡(feature)$\bf{x}$ã‹ã‚‰ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢çš„ã«æœ€ã‚‚è¿‘ã—ã„$\bf{k}$å€‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã¦ã€ãã®ä¸­ã®ä½•å€‹ãŒæŒ‡å®šã—ãŸãƒ©ãƒ™ãƒ«ã¨åŒå€¤ã¨ãªã‚‹ã‹ã‚’æ•°ãˆä¸Šã’ã¦ãã®å‰²åˆã‚’æ¨å®šå€¤ã¨ã—ã¦è¿”ã—ã¦ãã‚Œã‚‹ã€‚
 
![](https://storage.googleapis.com/zenn-user-upload/56nvrfs1yfdaitddk8qbe61cyckc)
>[Machine Learning: A Probabilistic Perspective (Adaptive Computation and Machine Learning series) P.16 Figure1.14ã‚ˆã‚Š](https://www.amazon.co.jp/Machine-Learning-Probabilistic-Perspective-Computation/dp/0262018020)

ä¸Šè¨˜ã®å›³ã®ä¾‹ã§è¨€ãˆã°ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹x_1ã‚„x_2ãŒK=3ã®æ•°ã ã‘ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒãƒˆã®ãƒã‚¤ãƒ³ãƒˆã‚’è¦‹ã¦ã€ãƒ©ãƒ™ãƒ«0ã®æ™‚ã®å‰²åˆã‚„ãƒ©ãƒ™ãƒ«ï¼‘ã®æ™‚ã®å‰²åˆã‚’è¿”ã™ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚
â€»ã¡ãªã¿ã«KNNã§ã‚ˆãä½¿ã‚ã‚Œã‚‹è·é›¢ã®æ¸¬åº¦åŸºæº–ã¯ä»Šå›ã‚‚ç”¨ã„ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ã ãŒã€ä»–ã®æ¸¬åº¦åŸºæº–ã€ä¾‹ãˆã°[ãƒãƒ³ãƒãƒƒã‚¿ãƒ³è·é›¢](https://manabitimes.jp/math/1127)ãªã©ã‚’ç”¨ã„ã‚‹ã“ã¨ã‚‚å‡ºæ¥ã‚‹ã€‚


# 2.KNNã‚’å®Ÿéš›ã«ç”¨ã„ãŸå…·ä½“ä¾‹
KNNã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ´ã‚€ãŸã‚ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ¶ç©ºã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸåˆ†é¡ã‚’ã—ã¦ã¿ã‚‹ã€‚
èº«é•·ã¨ä½“é‡ã‚’ç‰¹å¾´é‡ã¨ã—ã€æ€§åˆ¥ã‚’ãƒ©ãƒ™ãƒ«ã¨ã—ãŸã€‚
â€»èª¬æ˜ã®ãŸã‚ã«è‹¥å¹²æ¥µç«¯ãªæ•°å€¤è¨­å®šã«ã—ã¦ã‚ã‚‹ã€‚

|Name| ç‰¹å¾´é‡1(èº«é•·)| ç‰¹å¾´é‡2(ä½“é‡) | ãƒ©ãƒ™ãƒ«(æ€§åˆ¥) |
| ---- | ---- | ---- | ---- |
|Train-1| 180 | 60 | ç”· |
|Train-2| 170 | 55 | å¥³ |
|Train-3| 150 | 45 | å¥³ |
|Train-4| 150 | 50 | ç”· |
|Train-5| 160 | 55 | ç”· |
|Train-6| 150 | 52 | å¥³ |
>ç­†è€…ä½œæˆã®æ¶ç©ºãƒ‡ãƒ¼ã‚¿ï¼šåŒå¹´ä»£ã®ç”·å¥³ã®èº«é•·ã€ä½“é‡ã€æ€§åˆ¥ãƒ‡ãƒ¼ã‚¿ã®ãƒ†ãƒ¼ãƒ–ãƒ«

ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ä¸‹è¨˜3ã¤ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’ç”¨æ„ã™ã‚‹ã€‚

|Name| ç‰¹å¾´é‡1(èº«é•·)| ç‰¹å¾´é‡2(ä½“é‡) | ãƒ©ãƒ™ãƒ«(æ€§åˆ¥) |
| ---- | ---- | ---- | ---- |
|Test-7| 175 | 40 | ï¼Ÿ |
|Test-8| 155 | 65 | ï¼Ÿ |
|Test-9| 150 | 45 | ï¼Ÿ |

ä¸Šè¨˜ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”¨ã„ã¦(1)å®Ÿéš›ã«è¨ˆç®—ã‚’è¡Œã„ãã‚Œã‚’è¿½ã„ã‹ã‘ã¦ã„ãã€‚ãã®å¾Œã«(2)scikit-learnã‚’ç”¨ã„ã¦åˆ†é¡ã‚’ã™ã‚‹ã€‚

## 2.1.KNNã§è¡Œã‚ã‚Œã‚‹è¨ˆç®—
ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿iã¨ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿jã¨ã®ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢$d_{ij}$ã‚’è¨ˆç®—ã™ã‚‹ã€‚
ãƒ‡ãƒ¼ã‚¿iã®èº«é•·ã€ä½“é‡ã®ç‰¹å¾´é‡ã‚’ãã‚Œãã‚Œ$(x_i1, x_i2)$ã¨ã™ã‚‹ã€‚

$$\| d_{ij} \| =  \sqrt{(x_i1 - x_j1)^2 + (x_i2 - x_j2)^2}$$

ã§è¨ˆç®—å‡ºæ¥ã‚‹ã€‚ãã‚Œãã‚Œã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿é–“ã®ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ã®è¨ˆç®—çµæœã‚’ä¸‹è¨˜ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¾ã¨ã‚ãŸã€‚

| | Train-1 | Train-2 | Train-3 | Train-4 | Train-5 | Train-6 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| Test-7 | 20.6 | 15.8 | 25.4 | 26.9 | 21.2 | 27.7 |
| Test-8 | 25.4 | 18.0 | 20.6 | 15.8 | 11.1 | 13.9 |
| Test-9 | 33.5 | 22.3 | 0.0 | 5.0 | 14.1 | 7.0 |
â€»å°‘æ•°ç¬¬1ä½ä»¥ä¸‹ã¯åˆ‡ã‚Šæ¨ã¦

ä»¥ä¸Šã‹ã‚‰ã€
- Test-7
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-2ã€Train-1ã€Train-5ã€‚
ç”·æ€§å‰²åˆã¯$\frac{2}{3}$å¥³æ€§å‰²åˆã¯$\frac{1}{3}$
=>ä»¥ä¸Šã‚ˆã‚Šç”·æ€§
- Test-8
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-5ã€Train-6ã€Train-4ã€‚
ç”·æ€§å‰²åˆã¯$\frac{2}{3}$å¥³æ€§å‰²åˆã¯$\frac{1}{3}$
=>ä»¥ä¸Šã‚ˆã‚Šç”·æ€§
- Test-9
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-3ã€Train-4ã€Train-6ã€‚
ç”·æ€§å‰²åˆã¯$\frac{1}{3}$å¥³æ€§å‰²åˆã¯$\frac{2}{3}$
=>ä»¥ä¸Šã‚ˆã‚Šå¥³æ€§

ä¸Šè¨˜ã‚’å®Ÿéš›ã«ã‚°ãƒ©ãƒ•ã«ã—ãŸã‚‚ã®ãŒä¸‹è¨˜ã ã€‚
![](https://storage.googleapis.com/zenn-user-upload/mc4xpzejf6zqsrmp0mjgdxz4vo1l)


å¿µã®ãŸã‚ä¸Šè¨˜ã‚’Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚‚è©¦ã›ã‚‹ã‚ˆã†ã«è¨˜è¼‰ã—ã¦ãŠãã€‚
Pythonã‚’æ™®æ®µä½¿ã„ã•ã‚Œã¦ã„ã‚‹æ–¹ã¯ã‚³ãƒ”ãƒšç­‰ã—ã¦å®Ÿç’°å¢ƒã§è©¦ã—ã¦ã¿ã¦æ¬²ã—ã„ã€‚

:::details Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```
import math

X_train = [
        [180, 60],
        [170, 55],
        [150, 45],
        [150, 50],
        [160, 55],
        [150, 52],
        ]

X_test = [
        [175, 40],
        [155, 65],
        [150, 45]
        ]

if __name__ == "__main__":
    distances = [[None] * len(X_train) for _ in range(len(X_test))]
    for i, test in enumerate(X_test):
        for j, train in enumerate(X_train):
            distance = math.sqrt((train[0] - test[0]) ** 2 + (train[1] - test[1]) ** 2)
            distances[i][j] = [j+1, distance]
    for dl in distances:
        s_dl = sorted(dl, key=lambda x: x[1])
        print(s_dl)
--------------
[[2, 15.811388300841896], [1, 20.615528128088304], [5, 21.213203435596427], [3, 25.495097567963924], [4, 26.92582403567252], [6, 27.730849247724095]]

[[5, 11.180339887498949], [6, 13.92838827718412], [4, 15.811388300841896], [2, 18.027756377319946], [3, 20.615528128088304], [1, 25.495097567963924]]

[[3, 0.0], [4, 5.0], [6, 7.0], [5, 14.142135623730951], [2, 22.360679774997898], [1, 33.54101966249684]]
```
:::

ã•ã¦ã“ã“ã¾ã§è¡Œã£ã¦ããŸåˆ†æã¯ä¸€è¦‹æ­£ã—ã„ã‚ˆã†ã«æ€ã‚ã‚Œã‚‹ã€‚

ã—ã‹ã—æ•°å€¤ã‚’å¤‰ãˆã‚‹ã“ã¨ãªãã€å˜ä½ã‚’å¤‰ãˆã‚‹ã“ã¨ã§ä¸Šè¨˜ãŒãŠã‹ã—ã„ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ä¾‹ãˆã°èº«é•·ã‚’cmã§ã¯ãªãmã§è¡¨è¨˜ã—ã¦è¨ˆç®—ã™ã‚‹ã€‚


|Name| Train-1 | Train-2 | Train-3 | Train-4 | Train-5 | Train-6 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| Test-7 | 20.0 | 15.0 | 5.0 | 10.9 | 15.0 | 12.0 |
| Test-8 | 5.0 | 10.0 | 20.0 | 15.0 | 10.0 | 13.0 |
| Test-9 | 15.0 | 10.0 | 0.0 | 5.0 | 10.0 | 7.0 |

- Test-7
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-3ã€Train-4ã€Train-6ã€‚
ç”·æ€§å‰²åˆã¯$\frac{1}{3}$å¥³æ€§å‰²åˆã¯$\frac{2}{3}$
**=>ä»¥ä¸Šã‚ˆã‚Šå¥³æ€§**
- Test-8
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-1ã€Train-2ã€Train-5ã€‚
ç”·æ€§å‰²åˆã¯$\frac{2}{3}$å¥³æ€§å‰²åˆã¯$\frac{1}{3}$
=>ä»¥ä¸Šã‚ˆã‚Šç”·æ€§
- Test-9
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-3ã€Train-4ã€Train-6ã€‚
ç”·æ€§å‰²åˆã¯$\frac{1}{3}$å¥³æ€§å‰²åˆã¯$\frac{2}{3}$
=>ä»¥ä¸Šã‚ˆã‚Šå¥³æ€§

ä¸Šè¨˜ã‹ã‚‰æœ€åˆã®è¨ˆç®—çµæœã®Test-7ã¨åˆ†æã®çµæœãŒå¤‰ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚ã“ã‚Œã¯èº«é•·ã®å¹…ãŒå°ã•ããªã£ãŸã“ã¨ã«ã‚ˆã‚‹å½±éŸ¿ã ã€‚

ä»¥ä¸Šã‹ã‚‰**ãƒ‡ãƒ¼ã‚¿å¹…ãŒã‚ˆã‚Šå¤§ãã„ç‰¹å¾´é‡ãŒã€ç›¸å¯¾çš„ã«åˆ†æçµæœã«å¤§ãã„å½±éŸ¿åŠ›ã‚’æŒã¤(â‰’ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ã«ãŠã„ã¦å¤§ãã„å‰²åˆã‚’å ã‚ã‚‹)** ãŸã‚ã€ç•°ãªã‚‹å±æ€§ã®ç‰¹å¾´é‡ã‚’å‰å‡¦ç†ã›ãšã«åˆ†æã«ç”¨ã„ã‚‹ã®ã¯ä¸é©åˆ‡ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚

ãã“ã§ãƒ‡ãƒ¼ã‚¿ã®æœ€ä½å€¤ã€æœ€é«˜å€¤ã‚’è¨­å®šã—ã¦ã‚„ã‚Š0~1ã«ä¸¸ã‚è¾¼ã‚€(ç¸®å°ºã™ã‚‹)ã“ã¨ã§ãƒ‡ãƒ¼ã‚¿ã‚’å‰å‡¦ç†ã—ã€ä¸Šã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã“ã¨ã‚’è©¦ã¿ã‚‹ã€‚
â€»èª¬æ˜ã‚’ç°¡ç•¥åŒ–ã™ã‚‹ãŸã‚ã«æœ¬è¨˜äº‹ã§ã¯ä¸Šè¨˜ã®ã‚ˆã†ãªæ‰‹æ³•ã‚’æ¡ã‚‹ãŒã€æ­£è¦åˆ†å¸ƒã«å½“ã¦ã¯ã‚ã¦æ¨™æº–åŒ–(standardization)ã—ã¦ã‚„ã‚‹ãªã©ã—ã¦å‰å‡¦ç†ã‚’è¡Œã£ã¦ã‚‚è‰¯ã„ã€‚

ä»Šå›ã¯ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã«ãŠã‘ã‚‹èº«é•·ã®æœ€ä½å€¤150cmã‚’0ã«ã€æœ€é«˜å€¤ã®180cmã‚’1ã«ã™ã‚‹ã€‚åŒæ§˜ã«ä½“é‡ã¯æœ€ä½å€¤45kgã€æœ€é«˜å€¤ã‚’60kgã«è¨­å®šã™ã‚‹ã€‚

ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹ã€‚

|Name| ç‰¹å¾´é‡1(èº«é•·)| ç‰¹å¾´é‡2(ä½“é‡) | ãƒ©ãƒ™ãƒ«(æ€§åˆ¥) |
| ---- | ---- | ---- | ---- |
|Train-1| 1.000 | 1.000 | ç”· |
|Train-2| 0.666 | 0.666 | å¥³ |
|Train-3| 0.000 | 0.000 | å¥³ |
|Train-4| 0.000 | 0.333 | ç”· |
|Train-5| 0.333 | 0.666 | ç”· |
|Train-6| 0.000 | 0.466 | å¥³ |

ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹ã€‚

|Name| ç‰¹å¾´é‡1(èº«é•·)| ç‰¹å¾´é‡2(ä½“é‡) | ãƒ©ãƒ™ãƒ«(æ€§åˆ¥) |
| ---- | ---- | ---- | ---- |
|Test-7| 0.833 | -0.333 | ï¼Ÿ |
|Test-8| 0.166 | 1.333 | ï¼Ÿ |
|Test-9| 0.000 | 0.000 | ï¼Ÿ |

ä¸Šã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦å†åº¦ã€KNNã®è¨ˆç®—çµæœã‚’ç¢ºèªã™ã‚‹ã€‚

çµæœã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã£ãŸã€‚

|Name| Train-1 | Train-2 | Train-3 | Train-4 | Train-5 | Train-6 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| Test-7 | 1.343 | 1.013 | 0.897 | 1.067 | 1.118 | 1.155 |
| Test-8 | 0.897 | 0.833 | 1.343 | 1.013 | 0.687 | 0.882 |
| Test-9 | 1.414 | 0.942 | 0.000 | 0.333 | 0.745 | 0.466 |
â€»å°‘æ•°ç¬¬3ä½ä»¥ä¸‹ã¯åˆ‡ã‚Šæ¨ã¦


- Test-7
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-2ã€Train-1ã€Train-5ã€‚
ç”·æ€§å‰²åˆã¯$\frac{2}{3}$å¥³æ€§å‰²åˆã¯$\frac{1}{3}$
=>ä»¥ä¸Šã‚ˆã‚Šç”·æ€§
- Test-8
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-5ã€Train-2ã€Train-6ã€‚
ç”·æ€§å‰²åˆã¯$\frac{1}{3}$å¥³æ€§å‰²åˆã¯$\frac{2}{3}$
**=>ä»¥ä¸Šã‚ˆã‚Šå¥³æ€§**
- Test-9
è¿‘ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯Train-3ã€Train-4ã€Train-6ã€‚
ç”·æ€§å‰²åˆã¯$\frac{1}{3}$å¥³æ€§å‰²åˆã¯$\frac{2}{3}$
=>ä»¥ä¸Šã‚ˆã‚Šå¥³æ€§

ä¸Šè¨˜ã‚ˆã‚Šæœ€åˆã®è¨ˆç®—çµæœã‹ã‚‰Test-8ã®çµæœãŒå¤‰ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚ã“ã‚Œã¯èº«é•·ã¨ä½“é‡ã®ãƒ‡ãƒ¼ã‚¿å¹…ãŒ0~1ã«ä¸¸ã‚è¾¼ã¿ã•ã‚ŒãŸã“ã¨ã«ã‚ˆã‚Šã€äºˆæ¸¬ã«å¯¾ã™ã‚‹èº«é•·ã®ç›¸å¯¾çš„ãªå½±éŸ¿åŠ›ãŒä¸‹ãŒã‚Šã€ä½“é‡ã®å½±éŸ¿åŠ›ãŒä¸ŠãŒã£ãŸãŸã‚ã ã€‚

æ•£å¸ƒå›³ã®ã‚°ãƒ©ãƒ•ã‚‚ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹ã€‚ 
![](https://storage.googleapis.com/zenn-user-upload/ir3df596r5ovdufxvlws13f1xaul)

## 2.2.scikit-learnã§ã‚„ã£ã¦ã¿ã‚‹
[scikit-learn](https://github.com/scikit-learn/scikit-learn)ã¨ã¯Pythonã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹æ©Ÿæ¢°å­¦ç¿’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã ã€‚[3]
ä¸Šè¨˜ã¾ã§ã®åˆ†æã‚’scikit-learnã‚’ç”¨ã„ã¦å†åº¦è¡Œã†ã€‚ãªãŠã€ã“ã“ã§ã¯scikit-learnã®è©³ç´°ãªèª¬æ˜ã¯çœç•¥ã™ã‚‹ãŸã‚å‚è€ƒç¨‹åº¦ã«ç¢ºèªã—ã¦æ¬²ã—ã„ã€‚(KNNã‚’scikit-learnã§å®Ÿéš›ã«ç”¨ã„ã¦åˆ†æã‚’è¡Œã†è§£èª¬è¨˜äº‹ã¯åˆ¥é€”åŸ·ç­†äºˆå®š)

:::details scikit-learn
```
from sklearn.neighbors import KNeighborsClassifier
# index-0:height, index-1:weight
X_train = [
        [180, 60],
        [170, 55],
        [150, 45],
        [150, 50],
        [160, 55],
        [150, 52],
        ]
# Male:0, Female:1
y_train = [0, 1, 1, 0, 0, 1]
if __name__ == "__main__":
    # n_neighbors is the number of traning data to `look at`
    neigh = KNeighborsClassifier(n_neighbors=3)
    neigh.fit(X_train, y_train)
    # test data
    X_test = [
            [175, 40],
            [155, 75],
            [150, 45]
            ]
    print(neigh.predict(X_test))
--------------
[0 1 1]
```
:::


# 3.KNNã®å‹•ä½œã‚’æ•°å¼ã§è¡¨ç¾ã™ã‚‹
Section1ã®ã€ŒKNNã¨ã¯ãªã«ã‹ã€ã§è¿°ã¹ãŸã‚ˆã†ã«KNNã¯ã€Œãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å…¥åŠ›ã‹ã‚‰æœ€ã‚‚è¿‘ã—ã„$\bf{k}$å€‹ã®ãƒã‚¤ãƒ³ãƒˆã‚’è¦‹ã¦ã€æŒ‡å®šã—ãŸãƒ©ãƒ™ãƒ«ã¨åŒå€¤ã¨ãªã‚‹ã®ãŒä½•å€‹ã‹ã‚’æ•°ãˆä¸Šã’ã€ãã®å‰²åˆã‚’æ¨å®šå€¤ã¨ã—ã¦è¿”ã™ã€‚

ã“ã‚Œã‚’æ•°å¼ã§è¡¨ã™ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚

$$p(y=c|\bf{x}, \mathcal{D},K) = \frac{1}{K} \sum_{i\in{N_K(\bf{x}, \mathcal{D})}}^n \mathbb{I}(yi = c)$$

s.t.(ã“ã“ã§)ã€$N_K(\bf{x}, \mathcal{D})$ã¯ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ$\mathcal{D}$ã®ä¸­ã§ç‰¹å¾´é‡$\bf{x}$ã‚’æŒã¤ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã«æœ€ã‚‚è¿‘ã„$K$å€‹ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®é›†åˆã§ã‚ã‚‹ã€‚


ã¾ãŸã€ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼é–¢æ•°$\mathbb{I}$ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã‚‹ã€‚

ãŸã ã—$e$ã¯[é–¢ä¿‚å¼](https://kotobank.jp/word/%E9%96%A2%E4%BF%82%E5%BC%8F-469606)ã¨ã™ã‚‹ã€‚

$$
\mathbb{I}(e) = 
\begin{cases}
    1 \ \rm{if} \ e \ \rm{is} \ true \\
    0 \ \rm{if} \ e \ \rm{is} \ false
\end{cases}
$$


# ã¾ã¨ã‚
ä»Šå›ã¯KNNã¨ã„ã†ãƒ¢ãƒ‡ãƒ«ã®èƒŒæ™¯ã®è€ƒãˆæ–¹ã‚’ã¾ã¨ã‚ãŸã€‚ç¶šã„ã¦KNNãŒå®Ÿéš›ã«ã©ã†ã„ã£ãŸåˆ†æã‚’è¡Œã£ã¦ã„ã‚‹ã®ã‹ã‚’å®Ÿéš›ã«è¨ˆç®—ã—æ¤œè¨¼ã—ãŸã€‚ã¾ãŸKNNã‚’ã‚ˆã‚Šå³å¯†ã«æ‰ãˆã‚‹ãŸã‚ã«æ•°å¼ã§è¡¨ã—ãŸã€‚

ä¸€é€£ã®æ¤œè¨¼ã®çµæœã€KNNã«ç”¨ã„ãƒ‡ãƒ¼ã‚¿ã®ç‰¹å¾´é‡ã‚’é©åˆ‡ã«å‰å‡¦ç†ã—ã¦ã‚„ã‚‰ãªã„ã¨ã€åˆ†æçµæœã«ãƒ‡ãƒ¼ã‚¿å¹…ã®å¤§ãã„ç‰¹å¾´é‡ãŒéåº¦ã«å½±éŸ¿ã™ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚ãã“ã§ä»Šå›ã¯ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ã®ãŸã‚ã«ã€ç‰¹å¾´é‡ã®æœ€å¤§å€¤ã‚’1ã«ã€æœ€å°å€¤ã‚’0ã«ç¸®å°ºã™ã‚‹ã“ã¨ã§å¯¾å¿œã—ãŸã€‚

æ¬¡ã®è¨˜äº‹ã§ã¯ã€KNNã‚’scikit-learnã‚’ç”¨ã„ã¦MNISTã®åˆ†æã¨ãã®çµæœã‹ã‚‰å¾—ã‚‰ã‚ŒãŸè€ƒå¯Ÿã«ã¤ã„ã¦ã¾ã¨ã‚ã‚‹ã“ã¨ã§ã•ã‚‰ã«æ·±ãKNNã«ã¤ã„ã¦å­¦ã‚“ã§ã„ãã€‚

# å‚è€ƒæ–‡çŒ®
[1]: [Fix, Evelyn; Hodges, Joseph L. (1951). Discriminatory Analysis. Nonparametric Discrimination: Consistency Propertie](https://apps.dtic.mil/dtic/tr/fulltext/u2/a800276.pdf)

[2]:Toyama, Jun, Mineichi Kudo, and Hideyuki Imai. "Probably correct k-nearest neighbor search in high dimensions." Pattern Recognition 43.4 (2010): 1361-1372.

[3]:Fabian Pedregosa; GaÃ«l Varoquaux; Alexandre Gramfort; Vincent Michel; Bertrand Thirion; Olivier Grisel; Mathieu Blondel; Peter Prettenhofer; Ron Weiss; Vincent Dubourg; Jake Vanderplas; Alexandre Passos; David Cournapeau 

[Machine Learning: A Probabilistic Perspective (Adaptive Computation and Machine Learning series) Kevin P. Murphy](https://www.amazon.co.jp/Machine-Learning-Probabilistic-Perspective-Computation/dp/0262018020)
